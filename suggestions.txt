• Highest Impact

  1. Replace eval usage in helper.py:73. Executing LLM-selected strings is a security risk and slower than explicit dispatch. Prefer a whitelist like {"history": lambda t: t.history(period="5d"), "info": lambda t: t.info, ...}.
  2. Add robust JSON parsing guards in helper.py:41 and helper.py:58 (try/except json.JSONDecodeError + fallback). Right now one malformed model response can break the app.
  3. Standardize null handling across parser + app. prompts.py:16/prompts.py:19 says null, while simpleAgent.py:25 checks "NONE" and helper.py:68 checks 'None'. Use one convention (None) end-to-end.

  Optimization

  1. Avoid scanning methods per request in helper.py:21. inspect.getmembers(type(t)) is class-level and can be cached once with @lru_cache.
  2. Reduce token/cost in helper.py:117 by serializing compact JSON (json.dumps(yfi_output, default=str, separators=(",", ":"))) instead of Python dict repr.
  3. Validate LLM-selected methods against allowed methods before execution (helper.py:54 + helper.py:70) to prevent invalid calls and unnecessary exceptions.
  4. Consider caching finance fetches by (ticker, method_list) for short periods to reduce repeated network calls (simpleAgent.py:28 path).

  Brevity / Cleanliness

  1. Remove unused imports in helper.py:6 and helper.py:8 (pandas, ChatOllama).
  2. Fix type hints that don’t match returns: helper.py:32 currently annotated list but returns tuple; same pattern in a few functions.
  3. Simplify helper.py:60 to return content or [].
  4. Collapse duplicate chart checks in helper.py:85 and helper.py:87.
  5. Split long import line in simpleAgent.py:2 for readability and easier diffs.

  Prompt Quality

  1. SYSTEM_PROMPT in prompts.py:1 is very long and repetitive; shortening it will lower latency and improve consistency.
  2. EXTRACT_RELEVANT_METHOD_PROMPT in prompts.py:23 asks for entries like get("currentPrice"), which may not match callable methods discovered in code. Align prompt output format with actual executable method keys.
  3. Remove stylistic noise (prompts.py:9) from system behavior to improve deterministic outputs.

